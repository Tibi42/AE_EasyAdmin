{% extends 'base.html.twig' %}

{% block title %}Commande #{{ order.id }}
	- Auxilia E-commerce
{% endblock %}

{% block body %}
	<div class="py-5">
		<div class="d-flex justify-content-between align-items-center mb-5">
			<div>
				<h1 class="display-4 fw-bold text-primary mb-2">Commande #{{ order.id }}</h1>
				<p class="text-muted lead">D√©tails et r√©capitulatif de votre achat</p>
			</div>
			<a href="{{ path('app_orders') }}" class="btn btn-outline-secondary rounded-pill fw-bold">
				<i class="fas fa-arrow-left me-2"></i>Mes commandes
			</a>
		</div>

		<div
			class="row g-4">
			<!-- Colonne Principale -->
			<div
				class="col-lg-8">
				<!-- Liste des articles -->
				<div class="card border-0 shadow-sm rounded-4 overflow-hidden mb-4">
					<div class="card-header bg-white py-3 px-4 border-bottom">
						<h2 class="h5 fw-bold mb-0">Articles command√©s</h2>
					</div>
					<div class="card-body p-0">
						{% if order.orderItems|length > 0 %}
							<div class="table-responsive">
								<table class="table table-hover align-middle mb-0">
									<thead class="table-light">
										<tr>
											<th class="ps-4">Produit</th>
											<th class="text-center">Quantit√©</th>
											<th class="text-end">Prix unit.</th>
											<th class="text-end pe-4">Total</th>
										</tr>
									</thead>
									<tbody>
										{% for item in order.orderItems %}
											<tr>
												<td class="ps-4 fw-bold">{{ item.productName }}</td>
												<td class="text-center">{{ item.quantity }}</td>
												<td class="text-end">{{ item.price }}
													‚Ç¨</td>
												<td class="text-end pe-4 fw-bold">{{ item.total }}
													‚Ç¨</td>
											</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>
						{% else %}
							<div class="p-4 text-center text-muted">
								D√©tails des articles non disponibles pour cette commande.
							</div>
						{% endif %}
					</div>
				</div>

				<!-- Informations de la commande -->
				<div class="row g-4">
					<div class="col-md-6">
						<div class="card border-0 shadow-sm rounded-4 h-100">
							<div class="card-body p-4">
								<h3 class="h6 text-uppercase fw-bold text-muted mb-4">Infos Commande</h3>
								<div class="mb-3">
									<label class="small text-muted d-block">ID Commande</label>
									<span class="fw-bold">#{{ order.id }}</span>
								</div>
								<div class="mb-0">
									<label class="small text-muted d-block">Date d'achat</label>
									<span class="fw-bold">{{ order.dateat|date('d/m/Y √† H:i') }}</span>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6">
						<div class="card border-0 shadow-sm rounded-4 h-100">
							<div class="card-body p-4">
								<h3 class="h6 text-uppercase fw-bold text-muted mb-4">Statut actuel</h3>
								<div class="mb-4">
									<span class="badge rounded-pill px-4 py-2 fs-6
																					{% if order.status == 'pending' %}bg-warning text-dark
																					{% elseif order.status == 'confirmed' %}bg-info text-white
																					{% elseif order.status in ['shipped', 'delivered'] %}bg-success text-white
																					{% elseif order.status == 'cancelled' %}bg-danger text-white
																					{% else %}bg-secondary text-white{% endif %}">
										{% if order.status == 'pending' %}‚è≥ En attente
											{% elseif order.status == 'confirmed' %}‚úÖ Confirm√©e
											{% elseif order.status == 'shipped' %}üöö Exp√©di√©e
											{% elseif order.status == 'delivered' %}üì¶ Livr√©e
											{% elseif order.status == 'cancelled' %}‚ùå Annul√©e
										{% else %}
											{{ order.status|upper }}
										{% endif %}
									</span>
								</div>
								{% if order.status in ['paid', 'shipped', 'delivered'] %}
									<a href="{{ path('app_order_tracking', {id: order.id}) }}" class="btn btn-primary w-100 rounded-pill">
										<i class="fas fa-shipping-fast me-2"></i>Suivre mon colis
									</a>
								{% endif %}
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Colonne Lat√©rale : R√©sum√© Financier -->
			<div class="col-lg-4">
				<div class="card border-0 shadow-sm rounded-4 sticky-top" style="top: 2rem;">
					<div class="card-body p-4">
						<h2 class="h5 fw-bold mb-4">R√©sum√© financier</h2>

						<div class="d-flex justify-content-between mb-3">
							<span class="text-muted">Sous-total</span>
							<span class="fw-bold">{{ order.total }}
								‚Ç¨</span>
						</div>

						<div class="d-flex justify-content-between mb-4">
							<span class="text-muted">Livraison</span>
							<span class="text-success fw-bold">Gratuite</span>
						</div>

						<hr class="my-4 border-2">

						<div class="d-flex justify-content-between align-items-center mb-5">
							<span class="h4 fw-bold mb-0">Total</span>
							<span class="h3 fw-bold text-primary mb-0">{{ order.total }}
								‚Ç¨</span>
						</div>

						<div class="d-grid gap-3 pt-3 border-top">
							<a href="{{ path('app_product') }}" class="btn btn-primary btn-lg rounded-pill fw-bold">
								Continuer mes achats
							</a>
							<button class="btn btn-outline-secondary rounded-pill fw-bold" onclick="window.print()">
								<i class="fas fa-print me-2"></i>Imprimer facture
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
